(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const w={appNames:[],customJsonPrefixes:["archmage_"],hiveEngineSymbols:["ARCHMAGE","ARCHMAGEA","ARCHMAGEB","ARCHMAGEM"],color:"blue",label:"Archmage"},_={appNames:["actifit"],color:"red",customJsonPrefixes:["actifit"],hiveEngineSymbols:["AFIT","AFITX"],label:"Actifit"},C={color:"blue",customJsonPrefixes:["ac-"],label:"AC"},E={appNames:["beem","beempy"],color:"gray",label:"beem"},q={appNames:["beerlover"],color:"orange",hiveEngineSymbols:["BEER"],label:"Beer"},A={appNames:[],customJsonPrefixes:["cbm_"],hiveEngineSymbols:[""],color:"lightgreen"},I={appNames:[],color:"gray",customJsonPrefixes:[],hiveEngineSymbols:[""]},j={appNames:["CommentRewarder"],color:["gold"],customJsonPrefixes:[],hiveEngineSymbols:[""],label:"CR"},T={appNames:["CS"],color:"blue",label:"CS"},z={appNames:[],customJsonPrefixes:["dcrops"],hiveEngineSymbols:[""],color:"lightgreen",label:"dCrops"},L={appNames:["dbuzz"],color:"red",label:"dBuzz"},M={appNames:["distriator"],color:"green",label:"Distriator"},R={customJsonPrefixes:["dlux_"],label:"DLUX",color:"lightgreen"},W={appNames:[],color:"gray",customJsonPrefixes:[],hiveEngineSymbols:[""],label:"Downvote"},D={appNames:["ecency"],color:"blue",label:"Ecency",customJsonPrefixes:["ecency_","esteem_"],hiveEngineSymbols:[""]},$={appNames:["engage"],color:"blue",label:"Engage"},H={appNames:["engrave"],color:"blue",label:"Engrave"},U={color:"blue",customJsonPrefixes:["exode"],label:"Exode"},B={appNames:["exxp"],color:"blue",label:"Exxp"},F={appNames:[],color:"blue",customJsonPrefixes:["go_"],label:"GolemO"},G={appNames:[],color:"blue",customJsonPrefixes:["gls-"],hiveEngineSymbols:[""],label:"GLS"},Z={appNames:[],color:"red",customJsonPrefixes:["ssc-mainnet","scot_"],hiveEngineSymbols:[""],label:"H-E"},X={"app-names":[],color:"lightgreen",customJsonPrefixes:["qwoyn_"],hiveEngineSymbols:["BUDS","BUDSX","EXP"],label:"HashKings"},V={color:"hotpink",customJsonPrefixes:["pp_video"],label:"HiveTube"},K={"app-names":[],color:"purple","custom-json-ids":[],hiveEngineSymbols:["ZING"],label:"Holo"},Q={color:"yellow"},Y={color:"navyblue",customJsonPrefixes:["ic_"],label:"IC"},ee={appNames:["leothreads","leofinance"],color:"yellow",customJsonPrefixes:["leo_","inleo_"],label:"INLEO",url:"https://inleo.io"},oe={appNames:"la-colmena"},te={customJsonPrefixes:["lensy_"],label:"Lensy"},re={appNames:["liketu"],color:"bluegreen",customJsonPrefixes:["react"],label:"liketu",url:"https://www.liketu.com/"},ne={color:"blue",customJsonPrefixes:["mole-miner-"],label:"MuTerra"},se={color:"orange",customJsonPrefixes:["nftmart"],label:"NFTMart",url:"https://nftm.art"},le={customJsonPrefixes:["nftsr_"],label:"NTFSR"},ce={customJsonPrefixes:["op_"],label:"OP"},ae={color:"gray"},ie={customJsonPrefixes:["pm_"],label:"PKM",color:"orange"},ue={appNames:["peakd"],color:"lightgreen",customJsonPrefixes:["peakd_","beacon_custom_json"],label:"PeakD"},me={color:"bluegreen",customJsonPrefixes:["pigs_expired/1","reject_order/1","game_request/1","pack_purchase/1","confirm_order/1","fulfill_pigs/1","end_game/1","gmreq_","start_game/1","game_rewards/1","pig_upgrade/1","fulfill_points/1"],label:"Piggies"},fe={appNames:["pizzabot"],color:"yellow",hiveEngineSymbols:["PIZZA"],label:"PIZZA",url:"https://hive.pizza"},de={color:"lightgreen",customJsonPrefixes:["polls"],label:"polls"},pe={appNames:["Poshtoken 0.0.1","Poshtoken 0.0.2"],color:"yellow"},be={color:"lightgreen"},ge={color:"yellow",customJsonPrefixes:["pp_"],label:"podping"},ye={label:"PoB",customJsonPrefixes:["proofofbrain"],color:"gray"},he={color:"bluegreen",customJsonPrefixes:["duat_"],label:"Ragnarok"},ve={color:"hotpink",customJsonPrefixes:["riseofthepixels"],label:"RotP"},Se={appNames:["somee"],color:"red",label:"Somee"},xe={appNames:["3speak","3SpeakComment"],color:"bluegreen",customJsonPrefixes:["spkcc_","3speak-"],hiveEngineSymbols:[""],label:"Spk"},ke={appNames:["splinterboost"],color:"green",label:"Splinterboost"},Ne={appNames:["steemmonsters","splinterlands"],color:"green",customJsonPrefixes:["sm_","sl-","dev-sm_"],label:"SL"},Pe={appNames:["splintertalk"],color:"green",label:"Splintertalk"},Oe={appNames:["stemsocial"],color:"blue",label:"STEMSocial"},Je={color:"orange",customJsonPrefixes:["terracore_","tm_"],label:"Terracore"},we={color:"gray"},_e={appNames:["travelfeed"],color:"orange",label:"Travelfeed"},Ce={appNames:["Discord"],color:"blue",label:"Qurator"},Ee={appNames:["sportstalksocial"],hiveEngineSymbols:["SPORTS"],color:"blue",label:"Sportstalk"},qe={color:"gray"},Ae={color:"blue",customJsonPrefixes:"vsc.",label:"VSC"},Ie={appNames:["v4vapi"],color:"red",label:"V4V"},je={color:"orange",label:"VIMM"},Te={appNames:["waivio"],color:"gray",customJsonPrefixes:["wobj_","waivio_","follow_wobject"],label:"Waivio"},ze={color:"yellow",customJsonPrefixes:["woo_"],hiveEngineSymbols:["WOO","WOOALPHA","WOOSATURN","WOORAVEN"],label:"WOO"},c={archmage:w,actifit:_,arcadecolony:C,beem:E,beerlover:q,CBM:A,Comment:I,CommentRewarder:j,cryptoshots:T,dcrops:z,dbuzz:L,distriator:M,dlux:R,downvote:W,ecency:D,engage:$,enrave:H,exode:U,exxp:B,golemoverlord:F,gls:G,hiveengine:Z,hashkings:X,"Hive.blog":{appNames:["hiveblog"],color:"yellow-orange",label:"hive.blog"},hivetube:V,holozing:K,Holybread:Q,immortalcreed:Y,inleo:ee,lacolmena:oe,lensy:te,liketu:re,muterra:ne,nftmart:se,nftshowroom:le,oceanplanet:ce,Other:ae,peakmonsters:ie,peakd:ue,piggericks:me,PIZZA:fe,polls:de,Posh:pe,Post:be,podping:ge,proofofbrain:ye,ragnarok:he,riseofthepixels:ve,somee:Se,spk:xe,splinterboost:ke,splinterlands:Ne,splintertalk:Pe,stemsocial:Oe,terracore:Je,Xfer:we,travelfeed:_e,qurator:Ce,sportstalksocial:Ee,Up:qe,vsc:Ae,v4v:Ie,vimm:je,waivio:Te,WOO:ze},f=800,d=600;function S(e,o,n){return e<=o?o:e>=n?n:e}const Le=()=>Math.random()<.5?-1:1,i=e=>e*Le()*Math.random();function Me(e){var o=d3.select("svg#viz").selectAll("g").data(e);o.enter().append("g").attr("class","node").each(function(n){d3.select(this).append("circle").attr("class",function(t){return`${t.color} stroke`}).attr("r",function(t){return S(t.label.length*6.25,20,40)}),d3.select(this).append("text").attr("dominant-baseline","central").attr("text-anchor","middle").text(function(t){return t.label}).style("font-size","17px")}),o.exit().remove()}function Re(){var e=d3.select("svg#viz").selectAll("g");e.attr("transform",function(o){return"translate("+o.x+","+o.y+")"})}function We(e){const o=x(e);var n="";o?n=c[o].label:n=b(e);var t;return o?t=u(o):t=u(n),[{label:n,color:t,x:f/2+i(100),y:d/2+i(100)}]}function De(e){var o=[],n=e[1].json;try{n=JSON.parse(n)}catch(t){return console.warn("Invalid JSON:",t),[]}if(!n)return o;if(Array.isArray(n))for(const t of n){const r=N(t.contractPayload.symbol);if(!r)continue;const s=P(r),l=u(r);o.push({label:s,color:l,x:f/2+i(100),y:d/2+i(100)})}else if(n.contractPayload){const t=n.contractPayload.symbol,r=N(t);if(!r)return o;const s=P(r),l=u(r);console.debug(r,s,l),o.push({label:s,color:l,x:f/2+i(100),y:d/2+i(100)})}return o}function $e(e){if(document.querySelector("#flexCheckCustomJSONs").value=="true")return console.error("Custom JSON hidden"),[];var o=[],n=e[1].id;n.startsWith("ssc-mainnet")&&(o=o.concat(De(e)));const t=x(e);var r=b(e);r||console.error("missing label for:",t);var s;return t?s=u(t):s=u(r),o.push({label:r,color:s,x:f/2+i(100),y:d/2+i(100)}),o}function He(e){const o=b(e),n=u(o);return[{label:o,color:n,x:f/2+i(100),y:d/2+i(100)}]}function Ue(e){var o=[];return e.forEach(n=>{n.operations.forEach(t=>{const r=t[0];var s=[];r==="comment"?s=We(t):r==="custom_json"?s=$e(t):s=He(t),o=o.concat(s)})}),o}function N(e){for(const[o,n]of Object.entries(c))if(n.hiveEngineSymbols&&n.hiveEngineSymbols.includes(e))return console.debug("from HE symbol appId",o),o}function x(e){const o=e[0];var n=e[1].json_metadata;if(n)var n=JSON.parse(n);if(n&&n.app){var t=n.app;typeof t=="string"?(t=t.split("/")[0],t=t.split("-mobile-")[0]):t.name&&(t=t.name)}if(t&&console.debug("JSON app name",t),t){for(const[s,l]of Object.entries(c))if(l.appNames){for(const a of l.appNames)if(a.startsWith(t.toLowerCase()))return console.debug("appId",s),s}console.warn("Did not find app in registry: ",t)}if(o=="custom_json"){var r=e[1].id;for(const[s,l]of Object.entries(c))if(l.customJsonPrefixes){for(const a of l.customJsonPrefixes)if(r.startsWith(a))return console.debug("appId",s),s}}return null}function b(e){var o=e[0];if(o=="comment"){const l=x(e);return l&&!Object.keys(c[l]).includes("label")&&console.log(l,"missing label"),l&&c[l].label?(console.debug("app data",c[l]),c[l].label):(console.debug("Using opname as label"),o.charAt(0).toUpperCase()+o.slice(1))}else if(o=="custom_json"){var n=e[1].id,t=e[1].json,r=t.app;if(typeof r=="string"&&(r=r.split("/")[0],r=r.split("-mobile-")[0]),typeof r=="object"&&Object.keys(r).includes("name")&&(r=r.name),r){for(const l of Object.values(c))if(l.appNames){for(const a of l.appNames)if(a.startsWith(r))return console.debug("Labeled by app name:",l.label),l.label}}for(const l of Object.values(c))if(l.customJsonPrefixes){for(const a of l.customJsonPrefixes)if(n.startsWith(a))return l.label}return n=="notify"?"Notify":n=="follow"?"Follow":n=="reblog"?"Reblog":n=="community"?"Community":n==="rc"?"RC":(console.warn("Unrecognized CustomJSON id:",n),"Other")}else{if(o=="vote")return e[1].weight>0?"Up":"Down";if(o=="transfer")return"Xfer";if(o.startsWith("limit"))return"Market";if(o=="comment_options")return"Com Opts";var s=e[0].split("_")[0],s=s.charAt(0).toUpperCase()+s.slice(1);return s=s.substring(0,9),s}}function P(e){return Object.keys(c).includes(e)&&c[e].label?c[e].label:(console.warn("Label not found for: ",e),"Other")}function u(e){return Object.keys(c).includes(e)&&c[e].color?c[e].color:"gray"}function J(){var e=prompt("Enter block number:",document.querySelector("#blockNum").innerText);e=parseInt(e)-1,!e||e<0?h():(document.querySelector("#blockNum").data=`${e+1}`,document.querySelector("#blockNum").innerText=`${e}`),g()}document.querySelector("button#gotoblock").onclick=e=>{J()};function k(e){document.querySelector("button#play").hidden?(document.querySelector("button#pause").hidden=!0,document.querySelector("button#play").hidden=!1):(document.querySelector("button#play").hidden=!0,document.querySelector("button#pause").hidden=!1)}document.querySelector("button#pause").onclick=e=>{k()};document.querySelector("button#play").onclick=e=>{k()};function Be(){document.querySelector("#flexCheckCustomJSONs").value?document.querySelector("#flexCheckCustomJSONs").value=!1:document.querySelector("#flexCheckCustomJSONs").value=!0}document.querySelector("#flexCheckCustomJSONs").onclick=e=>{Be()};function p(e){const r=y();if(e)var s=r+1;else var s=r-1;s=S(s,1,10),document.querySelector("#speedgauge").data=`${s}`,document.querySelector("#speedgauge").innerText=`${s}x`}document.querySelector("button#fastforward").onclick=e=>{p(!0)};document.querySelector("button#backward").onclick=e=>{p(!1)};function y(){document.querySelector("#speedgauge").data||(document.querySelector("#speedgauge").data="1.0");var e=parseFloat(document.querySelector("#speedgauge").data);return e}hive.api.setOptions({url:"https://api.deathwing.me/"});function h(){hive.api.getDynamicGlobalProperties(function(e,o){if(e){console.error(e);return}var n=o.current_witness;document.querySelector("#currentWitness").innerText=`${n}`;var t=o.head_block_number;document.querySelector("#blockNum").innerText=`${t}`,document.querySelector("#blockNum").data=`${t}`,g()})}function g(){var e=document.querySelector("#blockNum").data;if(!e){console.debug("Failed to find block");return}hive.api.getBlock(e,function(o,n){if(o){console.error(o);return}var t=n;if(!t||!t.transactions)return;const r=t.transactions.length;document.querySelector("#blockSize").innerText=`${r.toLocaleString()} transactions`,d3.select("svg#viz").selectAll("g").remove();var s=Ue(t.transactions);Me(s),d3.forceSimulation(s).force("center",d3.forceCenter(f/2,d/2)).force("collision",d3.forceCollide().radius(function(l){return S(l.label.length*6.25,20,40)})).on("tick",Re).alpha(10),t.transactions.forEach(l=>{l.operations.forEach(a=>{a[0]==="custom_json"&&b(a)=="Other"&&console.warn("Unknown app",JSON.stringify(a))})}),document.querySelector("#blockNum").data==`${parseInt(e)}`&&(document.querySelector("#blockNum").data=`${parseInt(e)+1}`,document.querySelector("#blockNum").innerText=`${e}`,document.querySelector("#currentWitness").innerText=`${t.witness}`,document.querySelector("#timestamp").innerText=`${t.timestamp}`)}),console.info("Parsed block number:",e)}var O=new URLSearchParams(window.location.search);if(O.has("block")){var m=O.get("block"),m=parseInt(m);isNaN(m)||m<0?h():(document.querySelector("#blockNum").innerText=`${m}`,document.querySelector("#blockNum").data=`${m}`,g())}else h();function v(){document.querySelector("button#pause").hidden!=!0&&y()!=0&&g();var e=Math.abs(3e3/y());e!=1/0?setTimeout(()=>{v()},e):setTimeout(()=>{v()},1e3)}v();document.onkeydown=Fe;function Fe(e){e=e||window.event,e.keyCode=="38"||e.keyCode=="40"||(e.keyCode=="37"?p(!1):e.keyCode=="39"?p(!0):e.keyCode=="32"?k():e.keyCode=="83"&&J())}window.addEventListener("keydown",function(e){e.keyCode==32&&e.target==document.body&&e.preventDefault()});
