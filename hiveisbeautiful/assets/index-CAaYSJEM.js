(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const O={appNames:["actifit"],color:"red",customJsonPrefixes:["actifit"],hiveEngineSymbols:["AFIT","AFITX"],label:"Actifit"},_={appNames:[],customJsonPrefixes:["archmage_"],hiveEngineSymbols:["ARCHMAGE","ARCHMAGEA","ARCHMAGEB","ARCHMAGEM"],color:"blue",label:"Archmage"},C={color:"blue",customJsonPrefixes:["ac-"],label:"AC"},E={customJsonPrefixes:["Astral Wars"],label:"AstralWars"},q={appNames:["beem","beempy"],color:"gray",label:"beem"},A={appNames:["beerlover"],color:"orange",hiveEngineSymbols:["BEER"],label:"Beer"},I={appNames:[],customJsonPrefixes:["cbm_"],hiveEngineSymbols:[""],color:"lightgreen"},j={appNames:[],color:"gray",customJsonPrefixes:[],hiveEngineSymbols:[""]},T={appNames:["commentrewarder"],color:["gold"],customJsonPrefixes:[],hiveEngineSymbols:[""],label:"CR"},M={appNames:["cs"],color:"blue",label:"CS"},z={appNames:[],customJsonPrefixes:["dcrops"],hiveEngineSymbols:[""],color:"lightgreen",label:"dCrops"},L={appNames:["dbuzz"],color:"red",label:"dBuzz"},W={appNames:["distriator"],color:"green",label:"Distriator"},R={customJsonPrefixes:["dlux_"],label:"DLUX",color:"lightgreen"},D={appNames:[],color:"gray",customJsonPrefixes:[],hiveEngineSymbols:[""],label:"Downvote"},H={appNames:["ecency","ecency-waves"],color:"blue",label:"Ecency",customJsonPrefixes:["ecency_","esteem_"],hiveEngineSymbols:[""]},$={appNames:["engage"],color:"blue",label:"Engage"},B={appNames:["engrave"],color:"blue",label:"Engrave"},U={color:"blue",customJsonPrefixes:["exode"],label:"Exode"},F={appNames:["exxp"],color:"blue",label:"Exxp"},G={appNames:[],color:"blue",customJsonPrefixes:["go_"],label:"GolemO"},Z={appNames:[],color:"blue",customJsonPrefixes:["gls-"],hiveEngineSymbols:[""],label:"GLS"},X={appNames:[],color:"red",customJsonPrefixes:["ssc-mainnet","scot_"],hiveEngineSymbols:[""],label:"H-E"},V={appNames:[],color:"lightgreen",customJsonPrefixes:["qwoyn_"],hiveEngineSymbols:["BUDS","BUDSX","EXP"],label:"HashKings"},K={appNames:["hivediscomod"],label:"HiveDiscoMod"},Q={appNames:["hivesnaps"],color:"blue",label:"Snapie"},Y={color:"hotpink",customJsonPrefixes:["pp_video"],label:"HiveTube"},ee={appNames:[],color:"purple","custom-json-ids":[],hiveEngineSymbols:["ZING"],label:"Holo"},oe={color:"yellow",label:"Holybread"},te={color:"navyblue",customJsonPrefixes:["ic_"],label:"IC"},re={appNames:["leothreads","leofinance"],color:"yellow",customJsonPrefixes:["leo_","inleo_"],label:"INLEO",url:"https://inleo.io"},se={appNames:"la-colmena"},ne={customJsonPrefixes:["lensy_"],label:"Lensy"},le={appNames:["liketu"],color:"bluegreen",customJsonPrefixes:["react"],label:"liketu",url:"https://www.liketu.com/"},ae={color:"yellow-orange",customJsonPrefixes:["MagnetBank","magnetbank"],label:"MagnetBank"},ce={color:"blue",customJsonPrefixes:["mole-miner-"],label:"MuTerra"},ie={color:"orange",customJsonPrefixes:["nftmart"],label:"NFTMart",url:"https://nftm.art"},ue={customJsonPrefixes:["nftsr_"],label:"NTFSR"},me={customJsonPrefixes:["op_"],label:"OP"},fe={color:"gray"},pe={customJsonPrefixes:["pm_"],label:"PKM",color:"orange"},de={appNames:["peakd"],color:"lightgreen",customJsonPrefixes:["peakd_","beacon_custom_json"],label:"PeakD"},be={color:"bluegreen",customJsonPrefixes:["pigs_expired/1","reject_order/1","game_request/1","pack_purchase/1","confirm_order/1","fulfill_pigs/1","end_game/1","gmreq_","start_game/1","game_rewards/1","pig_upgrade/1","fulfill_points/1"],label:"Piggies"},ge={appNames:["pizzabot"],color:"yellow",hiveEngineSymbols:["PIZZA"],label:"PIZZA",url:"https://hive.pizza"},ye={color:"lightgreen",customJsonPrefixes:["polls"],label:"polls"},he={appNames:["poshtoken 0.0.1","poshtoken 0.0.2"],color:"yellow",label:"Posh"},ve={color:"lightgreen"},Se={color:"yellow",customJsonPrefixes:["pp_"],label:"podping"},ke={label:"PoB",customJsonPrefixes:["proofofbrain"],color:"gray"},xe={color:"bluegreen",customJsonPrefixes:["duat_"],label:"Ragnarok"},Ne={color:"hotpink",customJsonPrefixes:["riseofthepixels"],label:"RotP"},Pe={appNames:["somee"],color:"red",label:"Somee"},Je={appNames:["skatehive app 3.0"],color:"green",label:"Skate"},we={appNames:["3speak","3speakcomment"],color:"bluegreen",customJsonPrefixes:["spkcc_","3speak-"],hiveEngineSymbols:[""],label:"Spk"},Oe={appNames:["splinterboost"],color:"green",label:"Splinterboost"},_e={appNames:["steemmonsters","splinterlands"],color:"green",customJsonPrefixes:["sm_","sl-","dev-sm_"],label:"SL"},Ce={appNames:["splintertalk"],color:"green",label:"Splintertalk"},Ee={appNames:["stemsocial"],color:"blue",label:"STEMSocial"},qe={color:"orange",customJsonPrefixes:["terracore_","tm_"],label:"Terracore"},Ae={color:"gray"},Ie={appNames:["travelfeed"],color:"orange",label:"Travelfeed"},je={appNames:["discord"],color:"blue",label:"Qurator"},Te={appNames:["sportstalksocial"],hiveEngineSymbols:["SPORTS"],color:"blue",label:"Sportstalk"},Me={color:"gray"},ze={color:"blue",customJsonPrefixes:"vsc.",label:"VSC"},Le={appNames:["v4vapi"],color:"red",label:"V4V"},We={color:"orange",label:"VIMM"},Re={appNames:["waivio"],color:"gray",customJsonPrefixes:["wobj_","waivio_","follow_wobject"],label:"Waivio"},De={color:"yellow",customJsonPrefixes:["woo_"],hiveEngineSymbols:["WOO","WOOALPHA","WOOSATURN","WOORAVEN"],label:"WOO"},a={actifit:O,archmage:_,arcadecolony:C,astralwars:E,beem:q,beerlover:A,CBM:I,Comment:j,CommentRewarder:T,cryptoshots:M,dcrops:z,dbuzz:L,distriator:W,dlux:R,downvote:D,ecency:H,engage:$,enrave:B,exode:U,exxp:F,golemoverlord:G,gls:Z,hiveengine:X,hashkings:V,"hive.blog":{appNames:["hiveblog"],color:"yellow-orange",label:"hive.blog"},hivediscomod:K,hivesnaps:Q,hivetube:Y,holozing:ee,Holybread:oe,immortalcreed:te,inleo:re,lacolmena:se,lensy:ne,liketu:le,magnetbank:ae,muterra:ce,nftmart:ie,nftshowroom:ue,oceanplanet:me,Other:fe,peakmonsters:pe,peakd:de,piggericks:be,PIZZA:ge,polls:ye,Posh:he,Post:ve,podping:Se,proofofbrain:ke,ragnarok:xe,riseofthepixels:Ne,somee:Pe,skatehive:Je,spk:we,splinterboost:Oe,splinterlands:_e,splintertalk:Ce,stemsocial:Ee,terracore:qe,Xfer:Ae,travelfeed:Ie,qurator:je,sportstalksocial:Te,Up:Me,vsc:ze,v4v:Le,vimm:We,waivio:Re,WOO:De},f=800,p=600;function S(e,o,s){return e<=o?o:e>=s?s:e}const He=()=>Math.random()<.5?-1:1,i=e=>e*He()*Math.random();function $e(e){var o=d3.select("svg#viz").selectAll("g").data(e);o.enter().append("g").attr("class","node").each(function(s){d3.select(this).append("circle").attr("class",function(t){return`${t.color} stroke`}).attr("r",function(t){return S(t.label.length*6.25,20,40)}),d3.select(this).append("text").attr("dominant-baseline","central").attr("text-anchor","middle").text(function(t){return t.label}).style("font-size","17px")}),o.exit().remove()}function Be(){var e=d3.select("svg#viz").selectAll("g");e.attr("transform",function(o){return"translate("+o.x+","+o.y+")"})}function Ue(e){const o=k(e);var s="";o?s=a[o].label:s=b(e);var t;return o?t=u(o):t=u(s),[{label:s,color:t,x:f/2+i(100),y:p/2+i(100)}]}function Fe(e){var o=[],s=e[1].json;try{s=JSON.parse(s)}catch(t){return console.warn("Invalid JSON:",t),[]}if(!s)return o;if(Array.isArray(s))for(const t of s){const r=N(t.contractPayload.symbol);if(!r)continue;const n=P(r),l=u(r);o.push({label:n,color:l,x:f/2+i(100),y:p/2+i(100)})}else if(s.contractPayload){const t=s.contractPayload.symbol,r=N(t);if(!r)return o;const n=P(r),l=u(r);console.debug(r,n,l),o.push({label:n,color:l,x:f/2+i(100),y:p/2+i(100)})}return o}function Ge(e){if(document.querySelector("#flexCheckCustomJSONs").value=="true")return console.error("Custom JSON hidden"),[];var o=[],s=e[1].id;s.startsWith("ssc-mainnet")&&(o=o.concat(Fe(e)));const t=k(e);var r=b(e);r||console.error("missing label for:",t);var n;return t?n=u(t):n=u(r),o.push({label:r,color:n,x:f/2+i(100),y:p/2+i(100)}),o}function Ze(e){const o=b(e),s=u(o);return[{label:o,color:s,x:f/2+i(100),y:p/2+i(100)}]}function Xe(e){var o=[];return e.forEach(s=>{s.operations.forEach(t=>{const r=t[0];var n=[];r==="comment"?n=Ue(t):r==="custom_json"?n=Ge(t):n=Ze(t),o=o.concat(n)})}),o}function N(e){for(const[o,s]of Object.entries(a))if(s.hiveEngineSymbols&&s.hiveEngineSymbols.includes(e))return console.debug("from HE symbol appId",o),o}function k(e){const o=e[0];var s=e[1].json_metadata;if(s)var s=JSON.parse(s);if(s&&s.app){var t=s.app;typeof t=="string"?(t=t.split("/")[0],t=t.split("-mobile-")[0]):t.name&&(t=t.name)}if(t&&console.debug("JSON app name",t),t){for(const[n,l]of Object.entries(a))if(l.appNames){for(const c of l.appNames)if(c.startsWith(t.toLowerCase()))return console.debug("appId",n),n}console.warn("Did not find app in registry: ",t)}if(o=="custom_json"){var r=e[1].id;for(const[n,l]of Object.entries(a))if(l.customJsonPrefixes){for(const c of l.customJsonPrefixes)if(r.startsWith(c))return console.debug("appId",n),n}}return null}function b(e){var o=e[0];if(o=="comment"){const l=k(e);return l&&!Object.keys(a[l]).includes("label")&&console.log(l,"missing label"),l&&a[l].label?(console.debug("app data",a[l]),a[l].label):(console.debug("Using opname as label"),o.charAt(0).toUpperCase()+o.slice(1))}else if(o=="custom_json"){var s=e[1].id,t=e[1].json,r=t.app;if(typeof r=="string"&&(r=r.split("/")[0],r=r.split("-mobile-")[0]),typeof r=="object"&&Object.keys(r).includes("name")&&(r=r.name),r){for(const l of Object.values(a))if(l.appNames){for(const c of l.appNames)if(c.startsWith(r))return console.debug("Labeled by app name:",l.label),l.label}}for(const l of Object.values(a))if(l.customJsonPrefixes){for(const c of l.customJsonPrefixes)if(s.startsWith(c))return l.label}return s=="notify"?"Notify":s=="follow"?"Follow":s=="reblog"?"Reblog":s=="community"?"Community":s==="rc"?"RC":(console.warn("Unrecognized CustomJSON id:",s),"Other")}else{if(o=="vote")return e[1].weight>0?"Up":"Down";if(o=="transfer")return"Xfer";if(o.startsWith("limit"))return"Market";if(o=="comment_options")return"Com Opts";var n=e[0].split("_")[0],n=n.charAt(0).toUpperCase()+n.slice(1);return n=n.substring(0,9),n}}function P(e){return Object.keys(a).includes(e)&&a[e].label?a[e].label:(console.warn("Label not found for: ",e),"Other")}function u(e){return Object.keys(a).includes(e)&&a[e].color?a[e].color:"gray"}function w(){var e=prompt("Enter block number:",document.querySelector("#blockNum").innerText);e=parseInt(e)-1,!e||e<0?h():(document.querySelector("#blockNum").data=`${e+1}`,document.querySelector("#blockNum").innerText=`${e}`),g()}document.querySelector("button#gotoblock").onclick=e=>{w()};function x(e){document.querySelector("button#play").hidden?(document.querySelector("button#pause").hidden=!0,document.querySelector("button#play").hidden=!1):(document.querySelector("button#play").hidden=!0,document.querySelector("button#pause").hidden=!1)}document.querySelector("button#pause").onclick=e=>{x()};document.querySelector("button#play").onclick=e=>{x()};function Ve(){document.querySelector("#flexCheckCustomJSONs").value?document.querySelector("#flexCheckCustomJSONs").value=!1:document.querySelector("#flexCheckCustomJSONs").value=!0}document.querySelector("#flexCheckCustomJSONs").onclick=e=>{Ve()};function d(e){const r=y();if(e)var n=r+1;else var n=r-1;n=S(n,1,10),document.querySelector("#speedgauge").data=`${n}`,document.querySelector("#speedgauge").innerText=`${n}x`}document.querySelector("button#fastforward").onclick=e=>{d(!0)};document.querySelector("button#backward").onclick=e=>{d(!1)};function y(){document.querySelector("#speedgauge").data||(document.querySelector("#speedgauge").data="1.0");var e=parseFloat(document.querySelector("#speedgauge").data);return e}hive.api.setOptions({url:"https://api.deathwing.me/"});function h(){hive.api.getDynamicGlobalProperties(function(e,o){if(e){console.error(e);return}var s=o.current_witness;document.querySelector("#currentWitness").innerText=`${s}`;var t=o.head_block_number;document.querySelector("#blockNum").innerText=`${t}`,document.querySelector("#blockNum").data=`${t}`,g()})}function g(){var e=document.querySelector("#blockNum").data;if(!e){console.debug("Failed to find block");return}hive.api.getBlock(e,function(o,s){if(o){console.error(o);return}var t=s;if(!t||!t.transactions)return;const r=t.transactions.length;document.querySelector("#blockSize").innerText=`${r.toLocaleString()} transactions`,d3.select("svg#viz").selectAll("g").remove();var n=Xe(t.transactions);$e(n),d3.forceSimulation(n).force("center",d3.forceCenter(f/2,p/2)).force("collision",d3.forceCollide().radius(function(l){return S(l.label.length*6.25,20,40)})).on("tick",Be).alpha(10),t.transactions.forEach(l=>{l.operations.forEach(c=>{c[0]==="custom_json"&&b(c)=="Other"&&console.warn("Unknown app",JSON.stringify(c))})}),document.querySelector("#blockNum").data==`${parseInt(e)}`&&(document.querySelector("#blockNum").data=`${parseInt(e)+1}`,document.querySelector("#blockNum").innerText=`${e}`,document.querySelector("#currentWitness").innerText=`${t.witness}`,document.querySelector("#timestamp").innerText=`${t.timestamp}`)}),console.info("Parsed block number:",e)}var J=new URLSearchParams(window.location.search);if(J.has("block")){var m=J.get("block"),m=parseInt(m);isNaN(m)||m<0?h():(document.querySelector("#blockNum").innerText=`${m}`,document.querySelector("#blockNum").data=`${m}`,g())}else h();function v(){document.querySelector("button#pause").hidden!=!0&&y()!=0&&g();var e=Math.abs(3e3/y());e!=1/0?setTimeout(()=>{v()},e):setTimeout(()=>{v()},1e3)}v();document.onkeydown=Ke;function Ke(e){e=e||window.event,e.keyCode=="38"||e.keyCode=="40"||(e.keyCode=="37"?d(!1):e.keyCode=="39"?d(!0):e.keyCode=="32"?x():e.keyCode=="83"&&w())}window.addEventListener("keydown",function(e){e.keyCode==32&&e.target==document.body&&e.preventDefault()});
